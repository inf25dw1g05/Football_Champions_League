openapi: 3.0.0
info:
  title: Champions League
  version: 0.0.1
  description: 'Torneio da Champions League'
  contact:
    name: inf25dw1g05
    email: inf25dw1g05@gmail.com

servers:
- url: http://localhost:8080/{basePath}
  description: Champions League
  variables:
    basePath:
      default: /Groups
components:
  schemas:
    Team:
      title: Team
      type: object
      properties:
        team_id:
          type: integer
          format: int64
        name:
          type: string
        country:
          type: string
        coach:
          type: string
        group:
          type: string
      required:
      - name
      - country
      - coach
      - group
      additionalProperties: false

    Standing:
      type: object
      properties:
        team_id:
          type: integer
        team_name:
          type: string
        points:
          type: integer
        goal_difference:
          type: integer

    Player:
      title: Player
      type: object
      properties:
        player_id:
          type: integer
          format: int64
        name:
          type: string
        position:
          type: string
        nationality:
          type: string
        team_id:
          type: integer
          format: int64
        shirt_number:
          type: integer
          description: Número da camisola do jogador
          minimum: 1
          maximum: 99
      required:
      - name
      - position
      - nationality
      - team_id
      - shirt_number
      additionalProperties: false

    PlayerStats:
      type: object
      properties:
        player_id:
          type: integer
        player_name:
          type: string
        value:
          type: integer

    Match:
      title: Match
      type: object
      properties:
        match_id:
          type: integer
          format: int64
        home_team_id:
          type: integer
          format: int64
        away_team_id:
          type: integer
          format: int64
        match_date:
          type: string
          format: date
        venue:
          type: string
        home_score:
          type: integer
          default: 0
          minimum: 0
        away_score:
          type: integer
          default: 0
          minimum: 0
      required:
      - home_team_id
      - away_team_id
      additionalProperties: false

    MatchEvent:
      title: MatchEvent
      type: object
      properties:
        event_id:
          type: integer
          format: int64
        match_id:
          type: integer
          format: int64
        player_id:
          type: integer
          format: int64
        event_type:
          type: string
          enum: [ 'Goal', 'Yellow Card', 'Red Card', 'Assist' ]
        minute:
          type: integer
          minimum: 1
          maximum: 90
      required:
      - match_id
      - player_id
      - event_type
      - minute
      additionalProperties: false

  examples:
    TeamExample01:
      value:
        team_id: 1
        name: "Porto"
        country: "Portugal"
        coach: "Frascesco Farioli"
        group: "A"
    TeamExample02:
      value:
        team_id: 2
        name: "Liverpool"
        country: "England"
        coach: "Arne Slot"
        group: "A"
    PlayerExample01:
      value:
        player_id: 1
        name: "Victor Froholdt"
        position: "Central Midfield"
        nationality: "Danish"
        shirt_number: 8
        team_id: 1
    MatchExample01:
      value:
        match_id: 1
        home_team_id: 1
        away_team_id: 2
        match_date: "2025-11-15"
        venue: "Estádio do Dragão"
        home_score: 1
        away_score: 0
    MatchEventExample01:
      value:
        event_id: 1
        match_id: 1
        player_id: 1
        event_type: "Goal"
        minute: 29
paths:
  '/teams':
    get:
      tags:
      - TeamsController
      operationId: retrieveTeams
      summary: Ver equipas
      description: Ver todas as equipas, sendo possível filtrar!
      parameters:
      - name: country
        in: query
        description: Filtrar por país da equipa
        required: false
        schema:
          type: string
        example: "Portugal"
      - name: group
        in: query
        description: Filtrar por grupo da equipa
        required: false
        schema:
          type: string
        example: "A"
      - name: coach
        in: query
        description: Filtrar por nome do treinador
        required: false
        schema:
          type: string
        example: "Ancelotti"
      responses:
        '200':
          description: Array of Teams model instances
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Team'
                xml:
                  name: Teams
    post:
      tags:
      - TeamsController
      operationId: createTeam
      summary: Criar equipa
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Team'
      responses:
        '200':
          description: Create a Team model instance
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Team'

  '/teams/{id}':
    get:
      tags:
      - TeamsController
      operationId: retrieveTeam
      summary: Ver equipa em específico
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
          minimum: 1
        examples:
          one:
            value: 1
            summary: Retrieve Team id 1
          two:
            value: 2
            summary: Retrieve Team id 2
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Team'
        '400':
          description: Bad request
        '404':
          description: id not found
    put:
      tags:
      - TeamsController
      operationId: updateTeam
      summary: Atualizar Equipa
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                description: Team PUT Success
        '400':
          description: Bad request
        '404':
          description: id not found
      parameters:
      - name: id
        in: path
        schema:
          type: integer
          format: int64
          minimum: 1
        required: true
        examples:
          one:
            value: 1
            summary: Update Team id 1
          two:
            value: 2
            summary: Update Team id 2
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Team'
            examples:
              AeoportoExample01:
                $ref: '#/components/examples/TeamExample01'
              AeoportoExample02:
                $ref: '#/components/examples/TeamExample02'
    delete:
      tags:
      - TeamsController
      operationId: deleteTeam
      summary: Apagar Equipa
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
          minimum: 1
        examples:
          one:
            value: 1
            summary: Delete Team id 1
          two:
            value: 2
            summary: Delete Team id 2
      responses:
        '204':
          description: No content
        '404':
          description: id not found

  '/teams/{id}/matches':
    parameters:
    - name: id
      in: path
      description: ID da equipa da qual obter os jogos
      required: true
      schema:
        type: integer
        format: int64
    get:
      tags:
      - TeamsController
      summary: Listar jogos de uma equipa
      description: Obter todos os jogos (passados e futuros) de uma equipa específica.
      operationId: getMatchesByTeam
      responses:
        '200':
          description: Lista de jogos da equipa
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Match'
        '404':
          description: Equipa não encontrada

  '/teams/{id}/players':
    parameters:
    - name: id
      in: path
      description: ID da equipa da qual obter os jogadores
      required: true
      schema:
        type: integer
        format: int64
    get:
      tags:
      - TeamsController
      summary: Listar jogadores de uma equipa
      description: Obter todos os jogadores de uma equipa específica.
      operationId: getPlayersByTeam
      responses:
        '200':
          description: Lista de jogadores da equipa
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Player'
        '404':
          description: Equipa não encontrada

  '/players':
    get:
      tags:
      - PlayersController
      operationId: retrievePlayers
      summary: Ver Jogadores
      description: Ver todos os jogadores , sendo possível filtrar!
      parameters:
      - name: position
        in: query
        schema:
          type: string
        required: false
      - name: nationality
        in: query
        schema:
          type: string
        required: false
      - name: team_id
        in: query
        schema:
          type: integer
          format: int64
        required: false
      responses:
        '200':
          description: Lista de jogadores
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Player'
    post:
      tags:
      - PlayersController
      operationId: createPlayer
      summary: Criar Jogador
      description: Criar um novo jogador.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Player'
      responses:
        '200':
          description: Jogador criado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Player'

  '/players/{id}':
    get:
      tags:
      - PlayersController
      operationId: retrievePlayer
      summary: Ver jogador em específico
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        '200':
          description: Jogador encontrado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Player'
        '404':
          description: Jogador não encontrado

    put:
      tags:
      - PlayersController
      operationId: updatePlayer
      summary: Atualizar Jogador
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Player'
      responses:
        '200':
          description: Jogador Atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Player'
        '404':
          description: Jogador não encontrado

    delete:
      tags:
      - PlayersController
      operationId: deletePlayer
      summary: Apagar Jogador
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        '204':
          description: No content
        '404':
          description: Jogador não encontrado

  '/players/{id}/events':
    get:
      tags:
      - PlayersController
      operationId: getEventsByPlayer
      summary: Listar Eventos de um jogador específico
      parameters:
      - name: id
        in: path
        required: true
        description: ID do jogador
        schema:
          type: integer
          format: int64
      - name: type
        in: query
        required: false
        schema:
          type: string
          enum: [ Goal, Yellow Card, Red Card, Assist ]
      - name: match_id
        in: query
        required: false
        schema:
          type: integer
          format: int64
      responses:
        '200':
          description: Lista de eventos/acontecimentos do jogador
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MatchEvent'
        '404':
          description: Jogador não encontrado

  '/matches':
    post:
      tags:
      - MatchesController
      summary: Criar jogo
      description: Agendar / criar um novo jogo na competição.
      operationId: createMatch
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Match'
      responses:
        '201':
          description: Jogo criado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Match'

    get:
      tags:
      - MatchesController
      summary: Listar jogos
      description: Ver todos os jogos. Permite filtrar por equipa, data, grupo ou estado.
      operationId: retrieveMatches
      parameters:
      - name: team_id
        in: query
        description: Filtrar por ID da equipa.
        required: false
        schema:
          type: integer
      - name: date
        in: query
        description: Filtrar por data (YYYY-MM-DD).
        required: false
        schema:
          type: string
          format: date
      - name: group
        in: query
        description: Filtrar por grupo
        required: false
        schema:
          type: string
      - name: status
        in: query
        description: Estado do jogo - live, finished ou upcoming.
        required: false
        schema:
          type: string
          enum: [ live, finished, upcoming ]
      responses:
        '200':
          description: Lista de jogos
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Match'

  '/matches/{id}':
    get:
      tags:
      - MatchesController
      summary: Ver jogo
      description: Obter os detalhes de um jogo (equipas, estádio, data, resultado).
      operationId: retrieveMatch
      parameters:
      - name: id
        in: path
        required: true
        description: ID do jogo
        schema:
          type: integer
      responses:
        '200':
          description: Detalhes do jogo
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Match'
        '404':
          description: Jogo não encontrado

    put:
      tags:
      - MatchesController
      summary: Atualizar jogo
      description: Atualizar dados do jogo (venue, match_date ou resultado).
      operationId: updateMatch
      parameters:
      - name: id
        in: path
        required: true
        description: ID do jogo
        schema:
          type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Match'
      responses:
        '200':
          description: Jogo atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Match'
        '404':
          description: Jogo não encontrado

    delete:
      tags:
      - MatchesController
      summary: Remover jogo
      description: Cancelar ou eliminar um jogo.
      operationId: deleteMatch
      parameters:
      - name: id
        in: path
        required: true
        description: ID do jogo
        schema:
          type: integer
      responses:
        '204':
          description: Jogo removido
        '404':
          description: Jogo não encontrado

  '/matches/{id}/events':
    post:
      tags:
      - MatchEventsController
      summary: Criar evento do jogo
      description: Registar um novo evento (golo, cartão, assistência) no jogo.
      operationId: createEvent
      parameters:
      - name: id
        in: path
        required: true
        description: ID do jogo
        schema:
          type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MatchEvent'
      responses:
        '201':
          description: Evento criado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MatchEvent'
        '404':
          description: Jogo não encontrado

    get:
      tags:
      - MatchEventsController
      summary: Listar eventos do jogo
      description: Ver a timeline de eventos de um jogo específico.
      operationId: retrieveEvents
      parameters:
      - name: id
        in: path
        required: true
        description: ID do jogo
        schema:
          type: integer
      - name: type
        in: query
        required: false
        description: Filtrar por tipo de evento
        schema:
          type: string
          enum: [ 'Goal', 'Yellow Card', 'Red Card', 'Assist' ]
      - name: player_id
        in: query
        required: false
        description: Filtrar por ID do jogador.
        schema:
          type: integer
      responses:
        '200':
          description: Lista de eventos do jogo
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MatchEvent'
        '404':
          description: Jogo não encontrado

  '/events/{event_id}':
    put:
      tags:
      - MatchEventsController
      summary: Atualizar evento
      description: Corrigir um evento existente (ex. VAR altera tipo ou minuto).
      operationId: updateEvent
      parameters:
      - name: event_id
        in: path
        required: true
        description: ID do evento
        schema:
          type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MatchEvent'
      responses:
        '200':
          description: Evento atualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MatchEvent'
        '404':
          description: Evento não encontrado

    delete:
      tags:
      - MatchEventsController
      summary: Remover evento
      description: Anular um evento (ex. VAR anula um golo ou cartão).
      operationId: deleteEvent
      parameters:
      - name: event_id
        in: path
        required: true
        description: ID do evento
        schema:
          type: integer
      responses:
        '204':
          description: Evento removido
        '404':
          description: Evento não encontrado

  '/standings':
    get:
      tags:
      - StatsController
      summary: Obter classificação (standings)
      description: Calcular e devolver a tabela de classificação por grupo.
      operationId: getStandings
      parameters:
      - name: group
        in: query
        required: false
        description: Filtrar por grupo
        schema:
          type: string
      responses:
        '200':
          description: Tabela de classificação
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Standing'

  '/stats/top-scorers':
    get:
      tags:
      - StatsController
      summary: Melhores marcadores
      description: Lista dos jogadores com mais golos.
      operationId: getTopScorers
      responses:
        '200':
          description: Lista de melhores marcadores
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PlayerStats'

  '/stats/top-assists':
    get:
      tags:
      - StatsController
      summary: Melhores assistências
      description: Lista dos jogadores com mais assistências.
      operationId: getTopAssists
      responses:
        '200':
          description: Lista de melhores assistentes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PlayerStats'

  '/stats/discipline':
    get:
      tags:
      - StatsController
      summary: Estatísticas disciplinares
      description: Jogadores com mais cartões (amarelos/vermelhos).
      operationId: getDisciplineStats
      responses:
        '200':
          description: Estatísticas disciplinares
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PlayerStats'
